{"ast":null,"code":"var _jsxFileName = \"D:\\\\WorkSpace\\\\Website\\\\ISI-Group6-Sunset\\\\Full_Stack_Ecommerce\\\\admin\\\\src\\\\Components\\\\AddProduct\\\\AddProduct.jsx\",\n  _s = $RefreshSig$();\nimport React, { useState } from \"react\";\nimport \"./AddProduct.css\";\nimport upload_area from \"../Assets/upload_area.svg\";\nimport { backend_url } from \"../../App\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst AddProduct = () => {\n  _s();\n  const [mainImage, setMainImage] = useState(false);\n  const [additionalImages, setAdditionalImages] = useState([]);\n  const [isConfigurable, setIsConfigurable] = useState(false);\n  const [attributes, setAttributes] = useState([]);\n  const [options, setOptions] = useState([]);\n  const [skus, setSkus] = useState([]);\n  const [newAttribute, setNewAttribute] = useState({\n    attributeName: \"\",\n    details: \"\"\n  });\n  const [newOption, setNewOption] = useState({\n    option_name: \"\",\n    values: \"\"\n  });\n  const [productDetails, setProductDetails] = useState({\n    name: \"\",\n    description: \"\",\n    image: \"\",\n    additional_images: [],\n    category: \"women\",\n    new_price: \"\",\n    old_price: \"\",\n    isConfigurable: false,\n    categoryID: 1,\n    quantity: 0,\n    inventory_status: \"in_stock\"\n  });\n  const addAttribute = () => {\n    if (newAttribute.attributeName.trim() === \"\") return;\n    setAttributes([...attributes, {\n      attributeName: newAttribute.attributeName,\n      details: newAttribute.details\n    }]);\n    setNewAttribute({\n      attributeName: \"\",\n      details: \"\"\n    });\n  };\n  const addOption = () => {\n    if (newOption.option_name.trim() === \"\") return;\n    // 将逗号分隔的值转换为数组\n    const valuesArray = newOption.values.split(',').map(val => val.trim());\n    setOptions([...options, {\n      option_name: newOption.option_name,\n      values: valuesArray\n    }]);\n    setNewOption({\n      option_name: \"\",\n      values: \"\"\n    });\n  };\n  const generateSkus = () => {\n    // 清空当前SKUs\n    setSkus([]);\n\n    // 只处理有值的选项\n    const validOptions = options.filter(option => option.option_name && option.values && (Array.isArray(option.values) ? option.values.length > 0 : option.values.trim() !== ''));\n    console.log(\"Valid options for SKU generation:\", validOptions);\n    if (validOptions.length === 0) {\n      alert(\"请先添加至少一个有效的选项和值\");\n      return;\n    }\n\n    // 标准化选项和值\n    const normalizedOptions = validOptions.map(opt => ({\n      option_name: opt.option_name.trim(),\n      values: Array.isArray(opt.values) ? opt.values.map(v => v.trim()).filter(v => v !== '') : opt.values.split(',').map(v => v.trim()).filter(v => v !== '')\n    }));\n    console.log(\"Normalized options:\", normalizedOptions);\n\n    // 生成所有可能的组合\n    const generateAllCombinations = (options, index = 0, current = {}) => {\n      if (index === options.length) {\n        // 达到最后一个选项，添加当前组合\n        const basePrice = parseFloat(productDetails.new_price) || 0;\n\n        // 创建新的SKU对象\n        const newSku = {\n          configurable_values: {\n            ...current\n          },\n          // 复制当前组合\n          sku_code: `SKU-${skus.length + 1}`,\n          inventory_status: \"in_stock\",\n          quantity: 0,\n          price: basePrice,\n          image_url: \"\",\n          image_file: null\n        };\n        console.log(\"Adding new SKU:\", newSku);\n        setSkus(prev => [...prev, newSku]);\n        return;\n      }\n\n      // 获取当前选项\n      const option = options[index];\n\n      // 为当前选项的每个值创建一个组合\n      for (const value of option.values) {\n        const newCurrent = {\n          ...current\n        };\n        newCurrent[option.option_name] = value;\n        generateAllCombinations(options, index + 1, newCurrent);\n      }\n    };\n\n    // 启动组合生成\n    generateAllCombinations(normalizedOptions);\n  };\n  const updateSkuField = (index, field, value) => {\n    setSkus(prevSkus => {\n      const updatedSkus = [...prevSkus];\n      updatedSkus[index] = {\n        ...updatedSkus[index],\n        [field]: value\n      };\n      if (field === 'quantity') {\n        const quantity = parseInt(value) || 0;\n        updatedSkus[index].inventory_status = quantity > 0 ? 'in_stock' : 'out_of_stock';\n      }\n      return updatedSkus;\n    });\n  };\n  const removeAttribute = index => {\n    const newAttributes = [...attributes];\n    newAttributes.splice(index, 1);\n    setAttributes(newAttributes);\n  };\n  const removeOption = index => {\n    const newOptions = [...options];\n    newOptions.splice(index, 1);\n    setOptions(newOptions);\n  };\n  const removeSku = index => {\n    const newSkus = [...skus];\n    newSkus.splice(index, 1);\n    setSkus(newSkus);\n  };\n  const changeHandler = e => {\n    setProductDetails({\n      ...productDetails,\n      [e.target.name]: e.target.value\n    });\n  };\n  const toggleConfigurable = () => {\n    setIsConfigurable(!isConfigurable);\n    setProductDetails({\n      ...productDetails,\n      isConfigurable: !isConfigurable\n    });\n  };\n\n  // 修改主图片上传处理\n  const handleMainImageChange = e => {\n    if (e.target.files[0]) {\n      setMainImage(e.target.files[0]);\n    }\n  };\n\n  // 添加额外图片上传处理\n  const handleAdditionalImageChange = e => {\n    if (e.target.files) {\n      const newImages = [...additionalImages];\n      for (let i = 0; i < e.target.files.length; i++) {\n        newImages.push(e.target.files[i]);\n      }\n      setAdditionalImages(newImages);\n    }\n  };\n\n  // 移除附加图片\n  const removeAdditionalImage = index => {\n    const newImages = [...additionalImages];\n    newImages.splice(index, 1);\n    setAdditionalImages(newImages);\n  };\n\n  // 为SKU添加图片\n  const handleSkuImageChange = (index, e) => {\n    if (e.target.files[0]) {\n      const updatedSkus = [...skus];\n      updatedSkus[index].image_file = e.target.files[0];\n      setSkus(updatedSkus);\n    }\n  };\n\n  // 上传单个图片的辅助函数\n  const uploadImage = async imageFile => {\n    let formData = new FormData();\n    formData.append('product', imageFile);\n    try {\n      const response = await fetch(`${backend_url}/api/upload`, {\n        method: 'POST',\n        headers: {\n          Accept: 'application/json'\n        },\n        body: formData\n      });\n      return await response.json();\n    } catch (error) {\n      console.error(\"Image upload error:\", error);\n      return {\n        success: false,\n        error: \"Upload failed\"\n      };\n    }\n  };\n\n  // 修改添加产品方法以支持多图片上传\n  const AddProduct = async () => {\n    try {\n      let product = {\n        ...productDetails\n      };\n      let uploadedImages = [];\n\n      // 上传主图片\n      if (mainImage) {\n        const mainImageData = await uploadImage(mainImage);\n        if (mainImageData.success) {\n          product.image = mainImageData.image_url;\n          uploadedImages.push(mainImageData.image_url);\n        } else {\n          alert(\"Main image upload failed\");\n          return;\n        }\n      } else {\n        alert(\"Please select a main image\");\n        return;\n      }\n\n      // 上传附加图片\n      if (additionalImages.length > 0) {\n        const additionalImagePromises = additionalImages.map(img => uploadImage(img));\n        const additionalImageResults = await Promise.all(additionalImagePromises);\n        const successfulUploads = additionalImageResults.filter(result => result.success).map(result => result.image_url);\n        if (successfulUploads.length !== additionalImages.length) {\n          alert(\"Some additional images failed to upload\");\n        }\n        product.additional_images = successfulUploads;\n        uploadedImages = [...uploadedImages, ...successfulUploads];\n      }\n\n      // 如果是可配置产品，处理SKU图片\n      if (isConfigurable) {\n        product.attributes = attributes;\n        product.options = options;\n\n        // 处理SKU图片上传\n        const updatedSkus = [...skus];\n        for (let i = 0; i < updatedSkus.length; i++) {\n          if (updatedSkus[i].image_file) {\n            const skuImageData = await uploadImage(updatedSkus[i].image_file);\n            if (skuImageData.success) {\n              updatedSkus[i].image_url = skuImageData.image_url;\n              delete updatedSkus[i].image_file; // 删除文件对象，只保留URL\n            }\n          } else {\n            // 如果没有特定图片，使用主图片\n            updatedSkus[i].image_url = product.image;\n          }\n        }\n        product.skus = updatedSkus;\n      }\n\n      // 发送产品数据到后端\n      const response = await fetch(`${backend_url}/api/products/add`, {\n        method: 'POST',\n        headers: {\n          'Accept': 'application/json',\n          'Content-Type': 'application/json'\n        },\n        body: JSON.stringify(product)\n      });\n      const data = await response.json();\n      if (data.success) {\n        alert(`Product Added Successfully with ID: ${data.id}`);\n        resetForm();\n      } else {\n        alert(\"Failed to add product: \" + (data.errors || \"Unknown error\"));\n      }\n    } catch (error) {\n      console.error(\"Error adding product:\", error);\n      alert(\"Failed to add product. Please try again.\");\n    }\n  };\n\n  // 表单重置\n  const resetForm = () => {\n    setProductDetails({\n      name: \"\",\n      description: \"\",\n      image: \"\",\n      additional_images: [],\n      category: \"women\",\n      new_price: \"\",\n      old_price: \"\",\n      isConfigurable: false,\n      categoryID: 1,\n      quantity: 0,\n      inventory_status: \"in_stock\"\n    });\n    setMainImage(false);\n    setAdditionalImages([]);\n    setIsConfigurable(false);\n    setAttributes([]);\n    setOptions([]);\n    setSkus([]);\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"addproduct\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"addproduct-itemfield\",\n      children: [/*#__PURE__*/_jsxDEV(\"p\", {\n        children: \"Product title\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 324,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n        type: \"text\",\n        name: \"name\",\n        value: productDetails.name,\n        onChange: changeHandler,\n        placeholder: \"Type here\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 325,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 323,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"addproduct-itemfield\",\n      children: [/*#__PURE__*/_jsxDEV(\"p\", {\n        children: \"Product description\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 328,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n        type: \"text\",\n        name: \"description\",\n        value: productDetails.description,\n        onChange: changeHandler,\n        placeholder: \"Type here\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 329,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 327,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"addproduct-price\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"addproduct-itemfield\",\n        children: [/*#__PURE__*/_jsxDEV(\"p\", {\n          children: \"Price\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 333,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"number\",\n          name: \"old_price\",\n          value: productDetails.old_price,\n          onChange: changeHandler,\n          placeholder: \"Type here\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 334,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 332,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"addproduct-itemfield\",\n        children: [/*#__PURE__*/_jsxDEV(\"p\", {\n          children: \"Offer Price\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 337,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"number\",\n          name: \"new_price\",\n          value: productDetails.new_price,\n          onChange: changeHandler,\n          placeholder: \"Type here\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 338,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 336,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 331,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"addproduct-itemfield\",\n      children: [/*#__PURE__*/_jsxDEV(\"p\", {\n        children: \"Product category\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 342,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"select\", {\n        value: productDetails.category,\n        name: \"category\",\n        className: \"add-product-selector\",\n        onChange: changeHandler,\n        children: [/*#__PURE__*/_jsxDEV(\"option\", {\n          value: \"women\",\n          children: \"Women\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 344,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n          value: \"men\",\n          children: \"Men\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 345,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n          value: \"kid\",\n          children: \"Kid\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 346,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 343,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 341,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"addproduct-itemfield\",\n      children: [/*#__PURE__*/_jsxDEV(\"p\", {\n        children: \"Category ID\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 350,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n        type: \"number\",\n        name: \"categoryID\",\n        value: productDetails.categoryID,\n        onChange: changeHandler,\n        placeholder: \"Category ID\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 351,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 349,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"addproduct-itemfield\",\n      children: [/*#__PURE__*/_jsxDEV(\"p\", {\n        children: \"Product main image\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 356,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n        htmlFor: \"main-image-input\",\n        children: /*#__PURE__*/_jsxDEV(\"img\", {\n          className: \"addproduct-thumbnail-img\",\n          src: !mainImage ? upload_area : URL.createObjectURL(mainImage),\n          alt: \"\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 358,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 357,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n        onChange: handleMainImageChange,\n        type: \"file\",\n        name: \"mainImage\",\n        id: \"main-image-input\",\n        accept: \"image/*\",\n        hidden: true\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 360,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 355,\n      columnNumber: 7\n    }, this), !isConfigurable && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"addproduct-inventory\",\n      children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n        children: \"Inventory Information\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 364,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"inventory-form\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"addproduct-itemfield\",\n          children: [/*#__PURE__*/_jsxDEV(\"p\", {\n            children: \"Quantity\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 367,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"number\",\n            name: \"quantity\",\n            value: productDetails.quantity,\n            onChange: changeHandler,\n            placeholder: \"0\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 368,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 366,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"addproduct-itemfield\",\n          children: [/*#__PURE__*/_jsxDEV(\"p\", {\n            children: \"Inventory Status\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 377,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"select\", {\n            name: \"inventory_status\",\n            value: productDetails.inventory_status,\n            onChange: changeHandler,\n            className: \"add-product-selector\",\n            children: [/*#__PURE__*/_jsxDEV(\"option\", {\n              value: \"in_stock\",\n              children: \"In Stock\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 384,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n              value: \"out_of_stock\",\n              children: \"Out of Stock\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 385,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n              value: \"backorder\",\n              children: \"Back Order\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 386,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 378,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 376,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 365,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 363,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"addproduct-itemfield\",\n      children: [/*#__PURE__*/_jsxDEV(\"p\", {\n        children: \"Additional product images (optional)\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 395,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n        type: \"file\",\n        onChange: handleAdditionalImageChange,\n        multiple: true,\n        accept: \"image/*\",\n        className: \"additional-images-input\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 396,\n        columnNumber: 9\n      }, this), additionalImages.length > 0 && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"additional-images-preview\",\n        children: additionalImages.map((img, index) => /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"additional-image-item\",\n          children: [/*#__PURE__*/_jsxDEV(\"img\", {\n            src: URL.createObjectURL(img),\n            alt: `Additional ${index}`\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 408,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            type: \"button\",\n            onClick: () => removeAdditionalImage(index),\n            children: \"Remove\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 409,\n            columnNumber: 17\n          }, this)]\n        }, index, true, {\n          fileName: _jsxFileName,\n          lineNumber: 407,\n          columnNumber: 15\n        }, this))\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 405,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 394,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"addproduct-configurable\",\n      children: /*#__PURE__*/_jsxDEV(\"label\", {\n        children: [/*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"checkbox\",\n          checked: isConfigurable,\n          onChange: toggleConfigurable\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 419,\n          columnNumber: 11\n        }, this), \"Is Configurable Product\"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 418,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 417,\n      columnNumber: 7\n    }, this), isConfigurable && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"configurable-product-section\",\n      children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n        children: \"Product Attributes\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 431,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"attribute-input\",\n        children: [/*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"text\",\n          placeholder: \"Attribute Name\",\n          value: newAttribute.attributeName,\n          onChange: e => setNewAttribute({\n            ...newAttribute,\n            attributeName: e.target.value\n          })\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 433,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"text\",\n          placeholder: \"Details\",\n          value: newAttribute.details,\n          onChange: e => setNewAttribute({\n            ...newAttribute,\n            details: e.target.value\n          })\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 439,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: addAttribute,\n          children: \"Add Attribute\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 445,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 432,\n        columnNumber: 11\n      }, this), attributes.length > 0 && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"attributes-list\",\n        children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n          children: \"Added Attributes\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 450,\n          columnNumber: 15\n        }, this), attributes.map((attr, index) => /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"attribute-item\",\n          children: [/*#__PURE__*/_jsxDEV(\"p\", {\n            children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n              children: attr.attributeName\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 453,\n              columnNumber: 22\n            }, this), \": \", attr.details]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 453,\n            columnNumber: 19\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: () => removeAttribute(index),\n            children: \"Remove\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 454,\n            columnNumber: 19\n          }, this)]\n        }, index, true, {\n          fileName: _jsxFileName,\n          lineNumber: 452,\n          columnNumber: 17\n        }, this))]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 449,\n        columnNumber: 13\n      }, this), /*#__PURE__*/_jsxDEV(\"h3\", {\n        children: \"Product Options\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 460,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"option-input\",\n        children: [/*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"text\",\n          placeholder: \"Option Name (e.g. Color)\",\n          value: newOption.option_name,\n          onChange: e => setNewOption({\n            ...newOption,\n            option_name: e.target.value\n          })\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 462,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"text\",\n          placeholder: \"Values (comma separated, e.g. Red,Blue,Green)\",\n          value: newOption.values,\n          onChange: e => setNewOption({\n            ...newOption,\n            values: e.target.value\n          })\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 468,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: addOption,\n          children: \"Add Option\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 474,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 461,\n        columnNumber: 11\n      }, this), options.length > 0 && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"options-list\",\n        children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n          children: \"Added Options\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 479,\n          columnNumber: 15\n        }, this), options.map((opt, index) => /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"option-item\",\n          children: [/*#__PURE__*/_jsxDEV(\"p\", {\n            children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n              children: opt.option_name\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 483,\n              columnNumber: 21\n            }, this), \": \", Array.isArray(opt.values) ? opt.values.join(', ') : opt.values]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 482,\n            columnNumber: 19\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: () => removeOption(index),\n            children: \"Remove\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 485,\n            columnNumber: 19\n          }, this)]\n        }, index, true, {\n          fileName: _jsxFileName,\n          lineNumber: 481,\n          columnNumber: 17\n        }, this))]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 478,\n        columnNumber: 13\n      }, this), /*#__PURE__*/_jsxDEV(\"h3\", {\n        children: \"Manage SKUs\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 491,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: generateSkus,\n        children: \"Generate SKUs from Options\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 492,\n        columnNumber: 11\n      }, this), skus.length > 0 && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"skus-list\",\n        children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n          children: \"Product SKUs\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 496,\n          columnNumber: 15\n        }, this), /*#__PURE__*/_jsxDEV(\"table\", {\n          className: \"skus-table\",\n          children: [/*#__PURE__*/_jsxDEV(\"thead\", {\n            children: /*#__PURE__*/_jsxDEV(\"tr\", {\n              children: [/*#__PURE__*/_jsxDEV(\"th\", {\n                children: \"Configuration\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 500,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                children: \"SKU Code\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 501,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                children: \"Quantity\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 502,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                children: \"Price\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 503,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                children: \"Image\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 504,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                children: \"Action\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 505,\n                columnNumber: 21\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 499,\n              columnNumber: 19\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 498,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(\"tbody\", {\n            children: skus.map((sku, index) => /*#__PURE__*/_jsxDEV(\"tr\", {\n              children: [/*#__PURE__*/_jsxDEV(\"td\", {\n                className: \"configuration-cell\",\n                children: sku.configurable_values && typeof sku.configurable_values === 'object' ? /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"configuration-values\",\n                  children: Object.entries(sku.configurable_values).map(([optionName, optionValue]) => /*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"config-item\",\n                    children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n                      children: [optionName, \":\"]\n                    }, void 0, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 516,\n                      columnNumber: 33\n                    }, this), \" \", optionValue]\n                  }, optionName, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 515,\n                    columnNumber: 31\n                  }, this))\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 513,\n                  columnNumber: 27\n                }, this) : /*#__PURE__*/_jsxDEV(\"span\", {\n                  children: \"\\u65E0\\u914D\\u7F6E\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 521,\n                  columnNumber: 27\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 511,\n                columnNumber: 23\n              }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                children: /*#__PURE__*/_jsxDEV(\"input\", {\n                  type: \"number\",\n                  value: sku.quantity,\n                  onChange: e => updateSkuField(index, 'quantity', parseInt(e.target.value))\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 525,\n                  columnNumber: 25\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 524,\n                columnNumber: 23\n              }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                children: /*#__PURE__*/_jsxDEV(\"input\", {\n                  type: \"number\",\n                  value: sku.price,\n                  onChange: e => updateSkuField(index, 'price', parseFloat(e.target.value))\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 532,\n                  columnNumber: 25\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 531,\n                columnNumber: 23\n              }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                children: [/*#__PURE__*/_jsxDEV(\"input\", {\n                  type: \"file\",\n                  accept: \"image/*\",\n                  onChange: e => handleSkuImageChange(index, e)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 539,\n                  columnNumber: 25\n                }, this), sku.image_file && /*#__PURE__*/_jsxDEV(\"img\", {\n                  src: URL.createObjectURL(sku.image_file),\n                  alt: \"SKU preview\",\n                  className: \"sku-image-preview\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 545,\n                  columnNumber: 27\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 538,\n                columnNumber: 23\n              }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                children: /*#__PURE__*/_jsxDEV(\"button\", {\n                  onClick: () => removeSku(index),\n                  children: \"Remove\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 553,\n                  columnNumber: 25\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 552,\n                columnNumber: 23\n              }, this)]\n            }, index, true, {\n              fileName: _jsxFileName,\n              lineNumber: 510,\n              columnNumber: 21\n            }, this))\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 508,\n            columnNumber: 17\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 497,\n          columnNumber: 15\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 495,\n        columnNumber: 13\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 430,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n      className: \"addproduct-btn\",\n      onClick: AddProduct,\n      children: \"ADD\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 564,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 322,\n    columnNumber: 5\n  }, this);\n};\n_s(AddProduct, \"nJs2Q+c3615PeYFeNwKwE7GG7+Y=\");\n_c = AddProduct;\nexport default AddProduct;\nvar _c;\n$RefreshReg$(_c, \"AddProduct\");","map":{"version":3,"names":["React","useState","upload_area","backend_url","jsxDEV","_jsxDEV","AddProduct","_s","mainImage","setMainImage","additionalImages","setAdditionalImages","isConfigurable","setIsConfigurable","attributes","setAttributes","options","setOptions","skus","setSkus","newAttribute","setNewAttribute","attributeName","details","newOption","setNewOption","option_name","values","productDetails","setProductDetails","name","description","image","additional_images","category","new_price","old_price","categoryID","quantity","inventory_status","addAttribute","trim","addOption","valuesArray","split","map","val","generateSkus","validOptions","filter","option","Array","isArray","length","console","log","alert","normalizedOptions","opt","v","generateAllCombinations","index","current","basePrice","parseFloat","newSku","configurable_values","sku_code","price","image_url","image_file","prev","value","newCurrent","updateSkuField","field","prevSkus","updatedSkus","parseInt","removeAttribute","newAttributes","splice","removeOption","newOptions","removeSku","newSkus","changeHandler","e","target","toggleConfigurable","handleMainImageChange","files","handleAdditionalImageChange","newImages","i","push","removeAdditionalImage","handleSkuImageChange","uploadImage","imageFile","formData","FormData","append","response","fetch","method","headers","Accept","body","json","error","success","product","uploadedImages","mainImageData","additionalImagePromises","img","additionalImageResults","Promise","all","successfulUploads","result","skuImageData","JSON","stringify","data","id","resetForm","errors","className","children","fileName","_jsxFileName","lineNumber","columnNumber","type","onChange","placeholder","htmlFor","src","URL","createObjectURL","alt","accept","hidden","multiple","onClick","checked","attr","join","sku","Object","entries","optionName","optionValue","_c","$RefreshReg$"],"sources":["D:/WorkSpace/Website/ISI-Group6-Sunset/Full_Stack_Ecommerce/admin/src/Components/AddProduct/AddProduct.jsx"],"sourcesContent":["import React, { useState } from \"react\";\r\nimport \"./AddProduct.css\";\r\nimport upload_area from \"../Assets/upload_area.svg\";\r\nimport { backend_url } from \"../../App\";\r\n\r\nconst AddProduct = () => {\r\n  const [mainImage, setMainImage] = useState(false);\r\n  const [additionalImages, setAdditionalImages] = useState([]);\r\n  const [isConfigurable, setIsConfigurable] = useState(false);\r\n  const [attributes, setAttributes] = useState([]);\r\n  const [options, setOptions] = useState([]);\r\n  const [skus, setSkus] = useState([]);\r\n  const [newAttribute, setNewAttribute] = useState({ attributeName: \"\", details: \"\" });\r\n  const [newOption, setNewOption] = useState({ option_name: \"\", values: \"\" });\r\n  \r\n  const [productDetails, setProductDetails] = useState({\r\n    name: \"\",\r\n    description: \"\",\r\n    image: \"\",\r\n    additional_images: [],\r\n    category: \"women\",\r\n    new_price: \"\",\r\n    old_price: \"\",\r\n    isConfigurable: false,\r\n    categoryID: 1,\r\n    quantity: 0,\r\n    inventory_status: \"in_stock\"\r\n  });\r\n\r\n\r\n\r\n  const addAttribute = () => {\r\n    if (newAttribute.attributeName.trim() === \"\") return;\r\n    setAttributes([...attributes, {\r\n      attributeName: newAttribute.attributeName,\r\n      details: newAttribute.details\r\n    }]);\r\n    setNewAttribute({ attributeName: \"\", details: \"\" });\r\n  };\r\n\r\n  const addOption = () => {\r\n    if (newOption.option_name.trim() === \"\") return;\r\n    // 将逗号分隔的值转换为数组\r\n    const valuesArray = newOption.values.split(',').map(val => val.trim());\r\n    setOptions([...options, {\r\n      option_name: newOption.option_name,\r\n      values: valuesArray\r\n    }]);\r\n    setNewOption({ option_name: \"\", values: \"\" });\r\n  };\r\n\r\n  const generateSkus = () => {\r\n    // 清空当前SKUs\r\n    setSkus([]);\r\n    \r\n    // 只处理有值的选项\r\n    const validOptions = options.filter(option => \r\n      option.option_name && \r\n      option.values && \r\n      (Array.isArray(option.values) ? option.values.length > 0 : option.values.trim() !== '')\r\n    );\r\n    \r\n    console.log(\"Valid options for SKU generation:\", validOptions);\r\n    \r\n    if (validOptions.length === 0) {\r\n      alert(\"请先添加至少一个有效的选项和值\");\r\n      return;\r\n    }\r\n    \r\n    // 标准化选项和值\r\n    const normalizedOptions = validOptions.map(opt => ({\r\n      option_name: opt.option_name.trim(),\r\n      values: Array.isArray(opt.values) \r\n        ? opt.values.map(v => v.trim()).filter(v => v !== '') \r\n        : opt.values.split(',').map(v => v.trim()).filter(v => v !== '')\r\n    }));\r\n    \r\n    console.log(\"Normalized options:\", normalizedOptions);\r\n    \r\n    // 生成所有可能的组合\r\n    const generateAllCombinations = (options, index = 0, current = {}) => {\r\n      if (index === options.length) {\r\n        // 达到最后一个选项，添加当前组合\r\n        const basePrice = parseFloat(productDetails.new_price) || 0;\r\n        \r\n        // 创建新的SKU对象\r\n        const newSku = {\r\n          configurable_values: { ...current }, // 复制当前组合\r\n          sku_code: `SKU-${skus.length + 1}`,\r\n          inventory_status: \"in_stock\",\r\n          quantity: 0,\r\n          price: basePrice,\r\n          image_url: \"\",\r\n          image_file: null\r\n        };\r\n        \r\n        console.log(\"Adding new SKU:\", newSku);\r\n        setSkus(prev => [...prev, newSku]);\r\n        return;\r\n      }\r\n      \r\n      // 获取当前选项\r\n      const option = options[index];\r\n      \r\n      // 为当前选项的每个值创建一个组合\r\n      for (const value of option.values) {\r\n        const newCurrent = { ...current };\r\n        newCurrent[option.option_name] = value;\r\n        generateAllCombinations(options, index + 1, newCurrent);\r\n      }\r\n    };\r\n    \r\n    // 启动组合生成\r\n    generateAllCombinations(normalizedOptions);\r\n  };\r\n\r\n  const updateSkuField = (index, field, value) => {\r\n    setSkus(prevSkus => {\r\n      const updatedSkus = [...prevSkus];\r\n      updatedSkus[index] = {\r\n        ...updatedSkus[index],\r\n        [field]: value\r\n      };\r\n      if (field === 'quantity') {\r\n        const quantity = parseInt(value) || 0;\r\n        updatedSkus[index].inventory_status = quantity > 0 ? 'in_stock' : 'out_of_stock';\r\n      }\r\n      return updatedSkus;\r\n    });\r\n  };\r\n\r\n  const removeAttribute = (index) => {\r\n    const newAttributes = [...attributes];\r\n    newAttributes.splice(index, 1);\r\n    setAttributes(newAttributes);\r\n  };\r\n\r\n  const removeOption = (index) => {\r\n    const newOptions = [...options];\r\n    newOptions.splice(index, 1);\r\n    setOptions(newOptions);\r\n  };\r\n\r\n  const removeSku = (index) => {\r\n    const newSkus = [...skus];\r\n    newSkus.splice(index, 1);\r\n    setSkus(newSkus);\r\n  };\r\n\r\n  const changeHandler = (e) => {\r\n    setProductDetails({ ...productDetails, [e.target.name]: e.target.value });\r\n  };\r\n\r\n\r\n  const toggleConfigurable = () => {\r\n    setIsConfigurable(!isConfigurable);\r\n    setProductDetails({ ...productDetails, isConfigurable: !isConfigurable });\r\n  };\r\n\r\n  // 修改主图片上传处理\r\n  const handleMainImageChange = (e) => {\r\n    if (e.target.files[0]) {\r\n      setMainImage(e.target.files[0]);\r\n    }\r\n  };\r\n\r\n  // 添加额外图片上传处理\r\n  const handleAdditionalImageChange = (e) => {\r\n    if (e.target.files) {\r\n      const newImages = [...additionalImages];\r\n      for (let i = 0; i < e.target.files.length; i++) {\r\n        newImages.push(e.target.files[i]);\r\n      }\r\n      setAdditionalImages(newImages);\r\n    }\r\n  };\r\n\r\n  // 移除附加图片\r\n  const removeAdditionalImage = (index) => {\r\n    const newImages = [...additionalImages];\r\n    newImages.splice(index, 1);\r\n    setAdditionalImages(newImages);\r\n  };\r\n\r\n  // 为SKU添加图片\r\n  const handleSkuImageChange = (index, e) => {\r\n    if (e.target.files[0]) {\r\n      const updatedSkus = [...skus];\r\n      updatedSkus[index].image_file = e.target.files[0];\r\n      setSkus(updatedSkus);\r\n    }\r\n  };\r\n\r\n  // 上传单个图片的辅助函数\r\n  const uploadImage = async (imageFile) => {\r\n    let formData = new FormData();\r\n    formData.append('product', imageFile);\r\n\r\n    try {\r\n      const response = await fetch(`${backend_url}/api/upload`, {\r\n        method: 'POST',\r\n        headers: {\r\n          Accept: 'application/json',\r\n        },\r\n        body: formData,\r\n      });\r\n      return await response.json();\r\n    } catch (error) {\r\n      console.error(\"Image upload error:\", error);\r\n      return { success: false, error: \"Upload failed\" };\r\n    }\r\n  };\r\n\r\n  // 修改添加产品方法以支持多图片上传\r\n  const AddProduct = async () => {\r\n    try {\r\n      let product = { ...productDetails };\r\n      let uploadedImages = [];\r\n\r\n      // 上传主图片\r\n      if (mainImage) {\r\n        const mainImageData = await uploadImage(mainImage);\r\n        if (mainImageData.success) {\r\n          product.image = mainImageData.image_url;\r\n          uploadedImages.push(mainImageData.image_url);\r\n        } else {\r\n          alert(\"Main image upload failed\");\r\n          return;\r\n        }\r\n      } else {\r\n        alert(\"Please select a main image\");\r\n        return;\r\n      }\r\n\r\n      // 上传附加图片\r\n      if (additionalImages.length > 0) {\r\n        const additionalImagePromises = additionalImages.map(img => uploadImage(img));\r\n        const additionalImageResults = await Promise.all(additionalImagePromises);\r\n        \r\n        const successfulUploads = additionalImageResults\r\n          .filter(result => result.success)\r\n          .map(result => result.image_url);\r\n        \r\n        if (successfulUploads.length !== additionalImages.length) {\r\n          alert(\"Some additional images failed to upload\");\r\n        }\r\n        \r\n        product.additional_images = successfulUploads;\r\n        uploadedImages = [...uploadedImages, ...successfulUploads];\r\n      }\r\n\r\n      // 如果是可配置产品，处理SKU图片\r\n      if (isConfigurable) {\r\n        product.attributes = attributes;\r\n        product.options = options;\r\n        \r\n        // 处理SKU图片上传\r\n        const updatedSkus = [...skus];\r\n        for (let i = 0; i < updatedSkus.length; i++) {\r\n          if (updatedSkus[i].image_file) {\r\n            const skuImageData = await uploadImage(updatedSkus[i].image_file);\r\n            if (skuImageData.success) {\r\n              updatedSkus[i].image_url = skuImageData.image_url;\r\n              delete updatedSkus[i].image_file; // 删除文件对象，只保留URL\r\n            }\r\n          } else {\r\n            // 如果没有特定图片，使用主图片\r\n            updatedSkus[i].image_url = product.image;\r\n          }\r\n        }\r\n        product.skus = updatedSkus;\r\n      }\r\n\r\n      // 发送产品数据到后端\r\n      const response = await fetch(`${backend_url}/api/products/add`, {\r\n        method: 'POST',\r\n        headers: {\r\n          'Accept': 'application/json',\r\n          'Content-Type': 'application/json',\r\n        },\r\n        body: JSON.stringify(product),\r\n      });\r\n      \r\n      const data = await response.json();\r\n      \r\n      if (data.success) {\r\n        alert(`Product Added Successfully with ID: ${data.id}`);\r\n        resetForm();\r\n      } else {\r\n        alert(\"Failed to add product: \" + (data.errors || \"Unknown error\"));\r\n      }\r\n    } catch (error) {\r\n      console.error(\"Error adding product:\", error);\r\n      alert(\"Failed to add product. Please try again.\");\r\n    }\r\n  };\r\n\r\n  // 表单重置\r\n  const resetForm = () => {\r\n    setProductDetails({\r\n      name: \"\",\r\n      description: \"\",\r\n      image: \"\",\r\n      additional_images: [],\r\n      category: \"women\",\r\n      new_price: \"\",\r\n      old_price: \"\",\r\n      isConfigurable: false,\r\n      categoryID: 1,\r\n      quantity: 0,\r\n      inventory_status: \"in_stock\"\r\n    });\r\n    setMainImage(false);\r\n    setAdditionalImages([]);\r\n    setIsConfigurable(false);\r\n    setAttributes([]);\r\n    setOptions([]);\r\n    setSkus([]);\r\n  };\r\n\r\n  return (\r\n    <div className=\"addproduct\">\r\n      <div className=\"addproduct-itemfield\">\r\n        <p>Product title</p>\r\n        <input type=\"text\" name=\"name\" value={productDetails.name} onChange={changeHandler} placeholder=\"Type here\" />\r\n      </div>\r\n      <div className=\"addproduct-itemfield\">\r\n        <p>Product description</p>\r\n        <input type=\"text\" name=\"description\" value={productDetails.description} onChange={changeHandler} placeholder=\"Type here\" />\r\n      </div>\r\n      <div className=\"addproduct-price\">\r\n        <div className=\"addproduct-itemfield\">\r\n          <p>Price</p>\r\n          <input type=\"number\" name=\"old_price\" value={productDetails.old_price} onChange={changeHandler} placeholder=\"Type here\" />\r\n        </div>\r\n        <div className=\"addproduct-itemfield\">\r\n          <p>Offer Price</p>\r\n          <input type=\"number\" name=\"new_price\" value={productDetails.new_price} onChange={changeHandler} placeholder=\"Type here\" />\r\n        </div>\r\n      </div>\r\n      <div className=\"addproduct-itemfield\">\r\n        <p>Product category</p>\r\n        <select value={productDetails.category} name=\"category\" className=\"add-product-selector\" onChange={changeHandler}>\r\n          <option value=\"women\">Women</option>\r\n          <option value=\"men\">Men</option>\r\n          <option value=\"kid\">Kid</option>\r\n        </select>\r\n      </div>\r\n      <div className=\"addproduct-itemfield\">\r\n        <p>Category ID</p>\r\n        <input type=\"number\" name=\"categoryID\" value={productDetails.categoryID} onChange={changeHandler} placeholder=\"Category ID\" />\r\n      </div>\r\n      \r\n      {/* 修改主图片上传部分 */}\r\n      <div className=\"addproduct-itemfield\">\r\n        <p>Product main image</p>\r\n        <label htmlFor=\"main-image-input\">\r\n          <img className=\"addproduct-thumbnail-img\" src={!mainImage ? upload_area : URL.createObjectURL(mainImage)} alt=\"\" />\r\n        </label>\r\n        <input onChange={handleMainImageChange} type=\"file\" name=\"mainImage\" id=\"main-image-input\" accept=\"image/*\" hidden />\r\n      </div>\r\n      {!isConfigurable && (\r\n        <div className=\"addproduct-inventory\">\r\n          <h3>Inventory Information</h3>\r\n          <div className=\"inventory-form\">\r\n            <div className=\"addproduct-itemfield\">\r\n              <p>Quantity</p>\r\n              <input\r\n                type=\"number\"\r\n                name=\"quantity\"\r\n                value={productDetails.quantity}\r\n                onChange={changeHandler}\r\n                placeholder=\"0\"\r\n              />\r\n            </div>\r\n            <div className=\"addproduct-itemfield\">\r\n              <p>Inventory Status</p>\r\n              <select\r\n                name=\"inventory_status\"\r\n                value={productDetails.inventory_status}\r\n                onChange={changeHandler}\r\n                className=\"add-product-selector\"\r\n              >\r\n                <option value=\"in_stock\">In Stock</option>\r\n                <option value=\"out_of_stock\">Out of Stock</option>\r\n                <option value=\"backorder\">Back Order</option>\r\n              </select>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n      \r\n      {/* 添加多图片上传部分 */}\r\n      <div className=\"addproduct-itemfield\">\r\n        <p>Additional product images (optional)</p>\r\n        <input \r\n          type=\"file\" \r\n          onChange={handleAdditionalImageChange} \r\n          multiple \r\n          accept=\"image/*\" \r\n          className=\"additional-images-input\" \r\n        />\r\n        \r\n        {additionalImages.length > 0 && (\r\n          <div className=\"additional-images-preview\">\r\n            {additionalImages.map((img, index) => (\r\n              <div key={index} className=\"additional-image-item\">\r\n                <img src={URL.createObjectURL(img)} alt={`Additional ${index}`} />\r\n                <button type=\"button\" onClick={() => removeAdditionalImage(index)}>Remove</button>\r\n              </div>\r\n            ))}\r\n          </div>\r\n        )}\r\n      </div>\r\n      \r\n      {/* 可配置产品开关 */}\r\n      <div className=\"addproduct-configurable\">\r\n        <label>\r\n          <input \r\n            type=\"checkbox\"\r\n            checked={isConfigurable}\r\n            onChange={toggleConfigurable}\r\n          />\r\n          Is Configurable Product\r\n        </label>\r\n      </div>\r\n      \r\n      {/* 可配置产品特有部分 */}\r\n      {isConfigurable && (\r\n        <div className=\"configurable-product-section\">\r\n          <h3>Product Attributes</h3>\r\n          <div className=\"attribute-input\">\r\n            <input\r\n              type=\"text\"\r\n              placeholder=\"Attribute Name\"\r\n              value={newAttribute.attributeName}\r\n              onChange={(e) => setNewAttribute({...newAttribute, attributeName: e.target.value})}\r\n            />\r\n            <input\r\n              type=\"text\"\r\n              placeholder=\"Details\"\r\n              value={newAttribute.details}\r\n              onChange={(e) => setNewAttribute({...newAttribute, details: e.target.value})}\r\n            />\r\n            <button onClick={addAttribute}>Add Attribute</button>\r\n          </div>\r\n          \r\n          {attributes.length > 0 && (\r\n            <div className=\"attributes-list\">\r\n              <h4>Added Attributes</h4>\r\n              {attributes.map((attr, index) => (\r\n                <div key={index} className=\"attribute-item\">\r\n                  <p><strong>{attr.attributeName}</strong>: {attr.details}</p>\r\n                  <button onClick={() => removeAttribute(index)}>Remove</button>\r\n                </div>\r\n              ))}\r\n            </div>\r\n          )}\r\n          \r\n          <h3>Product Options</h3>\r\n          <div className=\"option-input\">\r\n            <input\r\n              type=\"text\"\r\n              placeholder=\"Option Name (e.g. Color)\"\r\n              value={newOption.option_name}\r\n              onChange={(e) => setNewOption({...newOption, option_name: e.target.value})}\r\n            />\r\n            <input\r\n              type=\"text\"\r\n              placeholder=\"Values (comma separated, e.g. Red,Blue,Green)\"\r\n              value={newOption.values}\r\n              onChange={(e) => setNewOption({...newOption, values: e.target.value})}\r\n            />\r\n            <button onClick={addOption}>Add Option</button>\r\n          </div>\r\n          \r\n          {options.length > 0 && (\r\n            <div className=\"options-list\">\r\n              <h4>Added Options</h4>\r\n              {options.map((opt, index) => (\r\n                <div key={index} className=\"option-item\">\r\n                  <p>\r\n                    <strong>{opt.option_name}</strong>: {Array.isArray(opt.values) ? opt.values.join(', ') : opt.values}\r\n                  </p>\r\n                  <button onClick={() => removeOption(index)}>Remove</button>\r\n                </div>\r\n              ))}\r\n            </div>\r\n          )}\r\n          \r\n          <h3>Manage SKUs</h3>\r\n          <button onClick={generateSkus}>Generate SKUs from Options</button>\r\n          \r\n          {skus.length > 0 && (\r\n            <div className=\"skus-list\">\r\n              <h4>Product SKUs</h4>\r\n              <table className=\"skus-table\">\r\n                <thead>\r\n                  <tr>\r\n                    <th>Configuration</th>\r\n                    <th>SKU Code</th>\r\n                    <th>Quantity</th>\r\n                    <th>Price</th>\r\n                    <th>Image</th>\r\n                    <th>Action</th>\r\n                  </tr>\r\n                </thead>\r\n                <tbody>\r\n                  {skus.map((sku, index) => (\r\n                    <tr key={index}>\r\n                      <td className=\"configuration-cell\">\r\n                        {sku.configurable_values && typeof sku.configurable_values === 'object' ? (\r\n                          <div className=\"configuration-values\">\r\n                            {Object.entries(sku.configurable_values).map(([optionName, optionValue]) => (\r\n                              <div key={optionName} className=\"config-item\">\r\n                                <strong>{optionName}:</strong> {optionValue}\r\n                              </div>\r\n                            ))}\r\n                          </div>\r\n                        ) : (\r\n                          <span>无配置</span>\r\n                        )}\r\n                      </td>\r\n                      <td>\r\n                        <input\r\n                          type=\"number\"\r\n                          value={sku.quantity}\r\n                          onChange={(e) => updateSkuField(index, 'quantity', parseInt(e.target.value))}\r\n                        />\r\n                      </td>\r\n                      <td>\r\n                        <input\r\n                          type=\"number\"\r\n                          value={sku.price}\r\n                          onChange={(e) => updateSkuField(index, 'price', parseFloat(e.target.value))}\r\n                        />\r\n                      </td>\r\n                      <td>\r\n                        <input \r\n                          type=\"file\" \r\n                          accept=\"image/*\" \r\n                          onChange={(e) => handleSkuImageChange(index, e)} \r\n                        />\r\n                        {sku.image_file && (\r\n                          <img \r\n                            src={URL.createObjectURL(sku.image_file)} \r\n                            alt=\"SKU preview\" \r\n                            className=\"sku-image-preview\" \r\n                          />\r\n                        )}\r\n                      </td>\r\n                      <td>\r\n                        <button onClick={() => removeSku(index)}>Remove</button>\r\n                      </td>\r\n                    </tr>\r\n                  ))}\r\n                </tbody>\r\n              </table>\r\n            </div>\r\n          )}\r\n        </div>\r\n      )}\r\n      \r\n      <button className=\"addproduct-btn\" onClick={AddProduct}>ADD</button>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default AddProduct;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}